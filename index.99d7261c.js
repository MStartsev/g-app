var base=[],ExcelToJSON=function(){this.parseExcel=function(t){var e=new FileReader;e.onload=function(t){var e=t.target.result;exelToObj(XLSX.read(e,{type:"binary"}))},e.onerror=function(t){console.log(t)},e.readAsBinaryString(t)}};function handleFileSelect(t){var e=t.target.files,r=new ExcelToJSON;try{r.parseExcel(e[0])}catch(e){r.parseExcel(t.dataTransfer.files[0])}}function exelToObj(t){new Map;var e=[0],r=!1;Object.values(t)[5]["Для цеху"]&&(e="Для цеху");var i=new Specification;if(i.Num=i.Num(t,e)||"БЕЗ НОМЕРУ","БЕЗ НОМЕРУ"==i.Num)return r=!0,void alert("УВАГА!\n ВІДСУТНІ ЗАГОЛОВКИ: \n Номер Специфікації.");if(i.Client=i.Client(t,e)||"Відсутній клієнт","Відсутній клієнт"==i.Client)return r=!0,void alert("УВАГА!\n ВІДСУТНІ ЗАГОЛОВКИ: \n Замовник.");i.titlesAdr.Marking=i.titlesAdr(t,e,/Маркування/i)||"-",i.titlesAdr.Metall=i.titlesAdr(t,e,/Вибір металу:/i)||"-",i.titlesAdr.Material=i.titlesAdr(t,e,/Матеріали/i)||"-",i.titlesAdr.Mat=i.titlesAdr(t,e,/Використати мат:/i)||"-",i.titlesAdr.MarkingSTOP=function(){return"-"==i.titlesAdr.Marking&&alert("УВАГА!\n ВІДСУТНІ ЗАГОЛОВКИ: \n Маркування."),"-"!=i.titlesAdr.Metall?i.titlesAdr.Metall[1].valueOf():"-"!=i.titlesAdr.Material?i.titlesAdr.Material[1].valueOf():"-"!=i.titlesAdr.Mat?i.titlesAdr.Mat[1].valueOf():(r=!0,alert("УВАГА!\n ВІДСУТНІ ЗАГОЛОВКИ: \n Вибір металу, Матеріали, Використати мат."),0)},i.titlesAdr.Name=i.titlesAdr(t,e,/Назва/i)||["z","1"],i.titlesAdr.Length=i.titlesAdr(t,e,/Довжина/i)||["z","1"],i.titlesAdr.Width=i.titlesAdr(t,e,/Ширина/i)||["z","1"],i.titlesAdr.Quantity=i.titlesAdr(t,e,/Кількість/i)||["z","1"],i.titlesAdr.Notes=i.titlesAdr(t,e,/Примітки/i)||["z","1"],i.titlesAdr.Notch=i.titlesAdr(t,e,/Вирізи/i)||["z","1"];var s="S"+i.Num.replace(/([ЗМІНА]{5}\d*)/g,"_$1_")+"___"+i.Client;s=s.replace(/[\s]/g,"").replace(/[/]/g,"_").replace(/["]/g,"__")+[],console.log(s,base),base.push(s),base.push(i.Num),base.push(i.Client),base.push(function(){if(!r){for(var s=function(r){var s=[],a=i.titlesAdr.Marking[0]+(1*i.titlesAdr.Marking[1]+r),l=i.titlesAdr.Name[0]+(1*i.titlesAdr.Name[1]+r),o=i.titlesAdr.Length[0]+(1*i.titlesAdr.Length[1]+r),c=i.titlesAdr.Width[0]+(1*i.titlesAdr.Width[1]+r),d=i.titlesAdr.Quantity[0]+(1*i.titlesAdr.Quantity[1]+r),u=i.titlesAdr.Notes[0]+(1*i.titlesAdr.Notes[1]+r),f=i.titlesAdr.Notch[0]+(1*i.titlesAdr.Notch[1]+r),v=void 0;try{(v=i.tableContent(t,e,a))&&(s.push(v),[l,o,c,d,u,f].forEach((function(r){(v=i.tableContent(t,e,r))?s.push(v):s.push("")})),n.push(s))}catch(t){}},n=[],a=i.titlesAdr.MarkingSTOP()-1*i.titlesAdr.Marking[1],l=1;l<a;l++)s(l);return n}}()),base.push([]),postServer(),console.log(base),base=[]}var Specification=function(){this.Num=function(t,e){for(var r=/([\u0410-\u042F\u0456i]{12}\s*[\u2116]\s*)(\d{1,})(\s*-?\d*)\s*(\u002F\s*\u0447?[\u043e\u0426]{0,2}\s*\u002F\u0423?[\u0415|e]?)/i,i=/[СПЕЦИФІКАЦІЯi]{12}\s/i,s=1;s<10;s++)for(var n=65;n<90;n++){var a=String.fromCharCode(n)+(s+"");try{if(i.test(Object.values(t)[5][e][a].w)){var l=Object.values(t)[5][e][a].w;return l=l.replace(r,"$2$4").replace(/\s{2,}/,"s").replace(/[«||»]/g,'"').toUpperCase()}}catch(t){}}},this.Client=function(t,e){for(var r=/\s*([Замовник]{8}\s*:*\s*)([\s\u0410-\u042F\u0456A-Z]*)/i,i=/[Замовник]{8}\s*:*\s*/i,s=1;s<10;s++)for(var n=65;n<90;n++){var a=String.fromCharCode(n)+(s+"");try{if(i.test(Object.values(t)[5][e][a].w)){var l=Object.values(t)[5][e][a].w;return l=l.replace(r,"$2").replace(/\s{2,}/,"s").replace(/[«||»]/g,'"').toUpperCase()}}catch(t){}}},this.titlesAdr=function(t,e,r){var i=10;r.test("/Вибір металу:/gi/Матеріали/ig/Використати мат:/gi")&&(i=1024);for(var s=1;s<i;s++)for(var n=65;n<90;n++){var a=String.fromCharCode(n)+(s+"");try{if(r.test(Object.values(t)[5][e][a].w))return[String.fromCharCode(n),s]}catch(t){}}},this.tableContent=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"G1";try{return Object.values(t)[5][e][r].w}catch(t){return!1}}};function getServer(){fetch("https://script.google.com/macros/s/AKfycbx9eFKQXavMnMh-p-ohpSV2vd3v5qL0o2TqCr9VfxvLuPFJyO8AUJtE7awTBy-M-eNv/exec").then((function(t){return t.json()})).then((function(t){document.getElementById("app").textContent=t[0].name,console.log(t)}))}function postServer(){console.info(base),fetch("https://script.google.com/macros/s/AKfycbx9eFKQXavMnMh-p-ohpSV2vd3v5qL0o2TqCr9VfxvLuPFJyO8AUJtE7awTBy-M-eNv/exec",{method:"POST",mode:"no-cors",cache:"no-cache",headers:{"Content-Type":"application/json"},direct:"fillow",reffererPolicy:"no-refferer",body:JSON.stringify({spec:base})})}document.getElementById("btn").addEventListener("click",getServer),document.getElementById("btn1").addEventListener("click",postServer);
//# sourceMappingURL=index.99d7261c.js.map
